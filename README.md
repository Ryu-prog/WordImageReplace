# WordImageReplace
Wordドキュメント（.docx / .dotx）内のヘッダー画像を、指定した画像ファイルに一括で差し替えるためのWPFデスクトップアプリケーションです。

# 概要
このツールは、Open XML SDKを利用してWordファイルの内部構造を直接操作し、テンプレートファイル内の特定のヘッダー画像を新しい画像（表面・裏面）に置き換えます。デザインテンプレートを維持したまま、中身の画像だけを更新したい業務効率化に最適です。

# 主な機能
- Wordファイル選択: 編集対象のWordファイル（.docx）を選択。
- 画像差し替え: 表面・裏面それぞれの差し替え用画像（png, jpg）を選択可能。
- Markdown: プレビューを横に表示Markdown: プレビューを横に表示
- 個別設定: 表面のみ、あるいは裏面のみの差し替えをチェックボックスで制御。
- プレビュー表示: 選択した差し替え用画像をアプリ上で確認可能。
- 自動保存: 前回使用したファイルパスを次回の起動時まで保持。

# 動作環境
Windows 10 / 11

.NET 8.0 以上（またはプロジェクトの設定に合わせたバージョン）

# 使い方
1. Wordファイル選択: 「Wordファイル選択」ボタンから対象のファイルを選びます。

1. 画像選択: 差し替えたい画像ファイルを「画像選択」ボタンから選びます。選択するとプレビューが表示されます。

1. 対象の選択: 「表面画像」「裏面画像」のうち、差し替えたい方にチェックを入れます。

1. 実行: 「画像差し替え実行」ボタンをクリックします。

1. 結果の確認: 元のファイルと同じフォルダに _fixed という接尾辞がついた新しいファイルが生成されます。

# 開発者向け情報
核となるロジックは OpenXmlWordHeaderReplacer.cs に集約されています。

- ReplaceHeaderImages: テンプレートのコピー作成から画像リレーションの張り替えまでを一括で行います。

- EMU（English Metric Units）計算により、画像の解像度に応じたサイズ調整を行っています。

## ダウンロード
最新版の実行ファイル（Windows用）は [こちらのリリースページ](https://github.com/Ryu-prog/WordImageReplace/releases/latest) からダウンロードできます。

ライセンス
MIT License

## 依存ライブラリ
このプロジェクトでは [Open XML SDK](https://github.com/dotnet/Open-XML-SDK) を使用しています。
ローカルでビルドする場合は、以下のコマンドを実行してパッケージを追加してください。

```bash
dotnet add package DocumentFormat.OpenXml
